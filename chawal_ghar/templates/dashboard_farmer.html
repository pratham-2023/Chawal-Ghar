{% extends "layout.html" %}

{% block content %}
<h2>Farmer Dashboard</h2>
<p>Welcome, {{ session['fullname'] }}!</p>

<!-- Rice Variety Reference Guide -->
<div style="margin: 30px 0;">
    <h4 style="color: #2e7d32; margin-bottom: 10px;">ðŸŒ¾ Quick Add Rice Stock</h4>
    <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">Click on any rice variety to quickly add it to your
        stock</p>
    <div class="rice-variety-reference">
        <a href="{{ url_for('add_product', rice_type='Basmati') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/basmati.png') }}" alt="Basmati">
            <span>Basmati</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Kolam') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/kolam.png') }}" alt="Kolam">
            <span>Kolam</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Sona Masoori') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/sona_masoori.png') }}" alt="Sona Masoori">
            <span>Sona Masoori</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Jasmine') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/jasmine.png') }}" alt="Jasmine">
            <span>Jasmine</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Brown') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/brown.png') }}" alt="Brown">
            <span>Brown</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Red') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/red.png') }}" alt="Red">
            <span>Red</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Black') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/black.png') }}" alt="Black">
            <span>Black</span>
        </a>
        <a href="{{ url_for('add_product', rice_type='Ponni') }}" class="variety-thumb">
            <img src="{{ url_for('static', filename='images/rice_varieties/ponni.png') }}" alt="Ponni">
            <span>Ponni</span>
        </a>
    </div>
</div>

<div style="margin-top: 40px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3>ðŸŒ¾ My Rice Stock</h3>
        <a href="{{ url_for('add_product') }}" class="btn">Add New Rice Stock</a>
    </div>

    {% if products %}
    <table style="width: 100%;">
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Quantity (kg)</th>
                <th>Price/Unit (â‚¹)</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product['p_name'] }}</td>
                <td>{{ product['p_type'] }}</td>
                <td>{{ product['p_quantity'] }}</td>
                <td>{{ product['p_priceperunit'] }}</td>
                <td>{{ product['p_status'] }}</td>
                <td>
                    <a href="{{ url_for('delete_product', p_id=product['p_id']) }}" class="btn btn-secondary"
                        style="background-color: #d32f2f; padding: 5px 10px; font-size: 0.8rem;"
                        onclick="return confirm('Delete this stock?')">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p><i>No rice stock listed yet.</i></p>
    {% endif %}
</div>

<div style="margin-top: 40px;">
    <h3>ðŸ“¦ Sales & Orders</h3>
    {% if orders %}
    <table>
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Rice</th>
                <th>Qty Sold (approx)</th>
                <th>Total â‚¹</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>#{{ order['o_id'] }}</td>
                <td>{{ order['c_fullname'] }}</td>
                <td>{{ order['p_name'] }}</td>
                <td>-</td>
                <td>â‚¹{{ order['o_amount'] }}</td>
                <td>{{ order['o_status'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p><i>No sales yet.</i></p>
    {% endif %}
</div>
{% endblock %}